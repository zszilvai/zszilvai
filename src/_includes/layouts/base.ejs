<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="icon" href="/favicon.ico" />
    <title><%= title %></title>
    <meta
      name="description"
      content="<%= (!!locals.description) ? description : site.description %>"
    />
    <meta name="author" content="<%= site.author %>" />
    <meta property="og:title" content="<%= title %>" />
    <meta
      property="og:description"
      content="<%= (!!locals.description) ? description : site.description %>"
    />
    <meta property="og:locale" content="<%= site.locale %>" />
    <meta property="og:site_name" content="<%= site.site_name %>" />
    <% if (locals.tags == "posts") { %>
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="<%= date.toISOString() %>" />
    <script type="application/ld+json">
      {
        "description": "<%= (!!locals.description) ? description : site.description %>",
        "author": { "@type": "Person", "name": "<%= site.author %>" },
        "@type": "BlogPosting",
        "url": "<%= `${site.url}${page.url}` %>",
        "publisher": {
          "@type": "Organization",
          "logo": {
            "@type": "ImageObject",
            "url": "<%= `${site.url}/assets/images/logo.png` %>"
          },
          "name": "<%= site.author %>"
        },
        "headline": "<%= title %>",
        "datePublished": "<%= date.toISOString() %>",
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "<%= `${site.url}${page.url}` %>"
        },
        "@context": "http://schema.org"
      }
    </script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script>
      $(function () {
        var mediumPromise = new Promise(function (resolve) {
          var $content = $('#jsonContent');
          var data = {
            rss: 'https://medium.com/feed/@zszilvai'
          };
          $.get(' https://api.rss2json.com/v1/api.json?rss_url=https%3A%2F%2Fmedium.com%2Ffeed%2F%40zszilvai', data, function (response) {
            if (response.status == 'ok') {
              $("#logo").append(`<img src="${response.feed["image"]}" class="rounded mx-auto d-block">`)
              var display = '';
              $.each(response.items, function (k, item) {
                display += `<div class="card mb-3 mx-auto mr-5 " style="width: 20rem;">`;
                var src = item["thumbnail"]; // use thumbnail url
                display += `<img src="${src}" class="card-img-top" alt="Cover image">`;
                display += `<div class="card-body">`;
                display += `<h5 class="card-title"><a href="${item.link}">${item.title}</a></h5>`;
                var yourString = item.description.replace(/<img[^>]*>/g,""); //replace with your string.
                yourString = yourString.replace('h4', 'p');
                yourString = yourString.replace('h3', 'p');
                var maxLength = 120; // maximum number of characters to extract
                //trim the string to the maximum length
                var trimmedString = yourString.substr(0, maxLength);
                //re-trim if we are in the middle of a word
                trimmedString = trimmedString.substr(0, Math.min(trimmedString.length, trimmedString.lastIndexOf(" ")))
                display += `<p class="card-text">${trimmedString}...</p>`;

                display += `<a href="${item.link}" target="_blank" class="btn btn-outline-success" >Read More</a>`;
                display += '</div></div>';
                return k < 10;
              });

              resolve($content.html(display));
            }
          });
        });

        mediumPromise.then(function()
        {
          //Pagination
          pageSize = 4;

          var pageCount = $(".card").length / pageSize;

          for (var i = 0; i < pageCount; i++) {
            $("#pagin").append(`<li class="page-item"><a class="page-link" href="#">${(i + 1)}</a></li> `);
          }
          $("#pagin li:nth-child(1)").addClass("active");
          showPage = function (page) {
            $(".card").hide();
            $(".card").each(function (n) {
              if (n >= pageSize * (page - 1) && n < pageSize * page)
                $(this).show();
            });
          }

          showPage(1);

          $("#pagin li").click(function () {
            $("#pagin li").removeClass("active");
            $(this).addClass("active");
            showPage(parseInt($(this).text()))
            return false;
          });
        });
      });
    </script>

    <% } %><%- include('webpack.ejs') %> <% if (page.url == "/") { %>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <script>
      if (window.netlifyIdentity) {
        window.netlifyIdentity.on('init', (user) => {
          if (!user) {
            window.netlifyIdentity.on('login', () => {
              document.location.href = '/admin/';
            });
          }
        });
      }
    </script>
    <% } %>
  </head>

  <body class="antialiased w-full text-gray-700">
    <div class="max-w-screen-lg mx-auto">
      <div class="border-b border-gray-300">
        <div class="pt-16 pb-8">
          <h1 class="font-semibold text-3xl text-gray-800"><%= site.title %></h1>
          <div class="text-xl"><%= site.description %></div>
        </div>
        <nav>
          <ul class="flex flex-wrap text-xl">
            <li class="mr-6">
              <a class="text-gray-700 border-none hover:no-underline hover:text-gray-800" href="/"
                >Home</a
              >
            </li>
            <li class="mr-6">
              <a
                class="text-gray-700 border-none hover:no-underline hover:text-gray-800"
                href="https://github.com/zszilvai/"
              >
                GitHub
              </a>
            </li>
            <li class="mr-6">
              <a
                class="text-gray-700 border-none hover:no-underline hover:text-gray-800"
                href="https://medium.com/@zszilvai/"
              >
                Blog
              </a>
            </li>
            <li class="mr-6">
              <a
                class="text-gray-700 border-none hover:no-underline hover:text-gray-800"
                href="https://medium.com/@zszilvai/"
              >
                Blog
              </a>
            </li>
          </ul>
        </nav>
      </div>

      <div class="text-xl py-5">
<!--        <%- content %>-->
        <div id="jsonContent"></div>
      </div>

      <div class="border-t border-gray-300 text-center py-8">
        Made with <span role="img" aria-label="Love">â™¥</span> by
        <a href="https://creativedesignsguru.com">CreativeDesignsGuru</a>
      </div>
    </div>
  </body>
</html>
